classdef RaviartThomasPlotter < handle

    methods ( Access = public)
        
        function obj = RaviartThomasPlotter()
        end
        
        function plot(obj,s)
            figure()
            hold on

            sx = [0 1 0 0.5 0 0.5];
            sy = [0 0 1 0 0.5 0.5];
            % sx = [0 1 0 0.5 0 0.5 0.25 0 0.75 0.75 0 0.25 0.25 0.5 0.25];
            % sy = [0 0 1 0 0.5 0.5 0 0.25 0 0.25 0.75 0.75 0.25 0.25 0.5];

            sx = [0, 1, 0, 0.5, 0, 0.5, 0.25, 0, 0.75, 0.75, 0, 0.25, ...
                  0.25, 0.5, 0.25, 0.125, 0, 0.875, 0.875, 0, 0.125, ...
                  0.375, 0.625, 0.375, 0.5, 0, 0, 0.125, 0.125, 0.625, ...
                  0.375, 0.5, 0.375, 0.125, 0.25, 0.125, 0.75, 0.625, ...
                  0.625, 0.125, 0.125, 0.25, 0.375, 0.25, 0.375];

            sy = [0, 0, 1, 0, 0.5, 0.5, 0, 0.25, 0, 0.25, 0.75, 0.75, ...
                  0.25, 0.25, 0.5, 0, 0.125, 0, 0.125, 0.875, 0.875, ...
                  0, 0, 0.125, 0.125, 0.375, 0.625, 0.375, 0.5, 0.375, ...
                  0.625, 0.375, 0.5, 0.125, 0.125, 0.25, 0.125, 0.125, ...
                  0.25, 0.75, 0.625, 0.625, 0.25, 0.375, 0.375];

            coord = s.mesh.computeXgauss([sx;sy]);

            z = s.func.evaluate([sx;sy]);
            s.mesh.plot();
            a = quiver(coord(1,:,:),coord(2,:,:),z(1,:,:),z(2,:,:),0.7);
            a.Color = [0 0 0];
            
            view(0,90)
            grid on
        end
        
    end
    
    methods (Access = private)
        
    end
    
end