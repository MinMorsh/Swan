Sub CrearTablaDeImagenes()
    Dim hoja As Worksheet
    Dim celda As Range
    Dim vectorPosicionesEta() As String
    Dim vectorPosicionesBeta() As String
    Dim contador As Integer
    Dim fila As String
    Dim columna As String
    
    Dim nombreImagen As String
    Dim celdaDestino As Range
    Dim imagen As Picture
    
    Call EliminarTodasLasImagenes
    
    ' Limpiar consola
    For i = 1 To 50
        Debug.Print
    Next i
    
    ' Especifica la hoja en la que deseas buscar las celdas azules
    Set hoja = ThisWorkbook.Sheets("Hoja1")
    
    ' Inicializa el contador y el vector de posiciones
    contador = 0
    
    ' Buscador de celdas Eta
    For Each celda In hoja.UsedRange.Cells
        ' Comprueba si la celda tiene formato de relleno azul
        If celda.Interior.Color = RGB(255, 0, 0) Then
            ' La celda está pintada de azul, guarda su posición en el vector
            contador = contador + 1
            ReDim Preserve vectorPosicionesEta(1 To contador)
            vectorPosicionesEta(contador) = celda.address
        End If
    Next celda
    contador = 0
    ' Buscador de celdas Beta
    For Each celda In hoja.UsedRange.Cells
        ' Comprueba si la celda tiene formato de relleno azul
        If celda.Interior.Color = RGB(0, 0, 255) Then
            ' La celda está pintada de azul, guarda su posición en el vector
            contador = contador + 1
            ReDim Preserve vectorPosicionesBeta(1 To contador)
            vectorPosicionesBeta(contador) = celda.address
        End If
    Next celda

    For i = LBound(vectorPosicionesBeta) To UBound(vectorPosicionesBeta)
        For j = LBound(vectorPosicionesEta) To UBound(vectorPosicionesEta)
            fila = Split(vectorPosicionesBeta(i), "$")(2)
            columna = Split(vectorPosicionesEta(j), "$")(1)
            Debug.Print columna & fila
            Set celdaDestino = Range(columna & fila)
            beta = Range(vectorPosicionesBeta(i)).Value
            eta = Range(vectorPosicionesEta(j)).Value * 100
            Debug.Print beta & "  " & eta
            nombreImagen = "Eta" & eta & "Beta" & beta & "Iter150NonMorph.png"
            rutaImagen = Left$(ThisWorkbook.Path, Len(ThisWorkbook.Path)) & "\" & nombreImagen
            Set imagen = ThisWorkbook.Sheets("Hoja1").Pictures.Insert(rutaImagen)
            
            With imagen
                .ShapeRange.LockAspectRatio = msoFalse
                .Left = celdaDestino.Left
                .Top = celdaDestino.Top
                .Width = celdaDestino.Width
                .Height = celdaDestino.Height
            End With
        Next j
    Next i
    
    
    ' Parametros de consola
    
    For i = LBound(vectorPosicionesEta) To UBound(vectorPosicionesEta)
        Debug.Print "Eta " & i & ":" & vectorPosicionesEta(i)
    Next i
    For i = LBound(vectorPosicionesBeta) To UBound(vectorPosicionesBeta)
        Debug.Print "Beta " & i & ":" & vectorPosicionesBeta(i)
    Next i
End Sub


Sub EliminarTodasLasImagenes()
    Dim hoja As Worksheet
    Set hoja = ThisWorkbook.Sheets("Hoja1") ' Cambia "NombreHoja" por el nombre de la hoja en la que deseas eliminar las imágenes
    
    ' Verificar si la hoja tiene imágenes
    If hoja.Pictures.Count > 0 Then
        ' Eliminar cada imagen de la hoja
        Dim imagen As Picture
        For Each imagen In hoja.Pictures
            imagen.Delete
        Next imagen
        
    End If
End Sub

