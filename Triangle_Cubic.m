classdef Triangle_Cubic < Interpolation
    
    methods (Access = public)
        
        function obj = Triangle_Cubic(cParams)
            obj.init(cParams);
            obj.computeParams();
        end
        
        function computeShapeDeriv(obj,posgp)
            obj.computeShapes(posgp);
            obj.computeShapeDerivatives(posgp);
        end
        
    end
    
    methods (Access = private)
        
        function computeParams(obj)
            obj.type = 'TRIANGLE_CUBIC';
            obj.ndime = 2;
            obj.nnode = 10;
            obj.pos_nodes = [0,0 ; 1 0; 0,1 ; 1/3,0 ; 2/3,0 ; 2/3,1/3 ;...
                1/3,2/3 ; 0,2/3 ; 0,1/3 ; 1/3,1/3];
        end
        
        function computeShapes(obj,posgp)
         ngaus = size(posgp,2);
            for igaus=1:ngaus
                s = posgp(1,igaus);
                t = posgp(2,igaus);
                obj.shape(:,igaus) = [s.*(-1.1e+1./2.0)-t.*(1.1e+1./2.0)+s.*t.*1.8e+1-s.*t.^2.*(2.7e+1./2.0)-s.^2.*t.*(2.7e+1./2.0)+s.^2.*9.0-s.^3.*(9.0./2.0)+t.^2.*9.0-t.^3.*(9.0./2.0)+1.0;...
                    s-s.^2.*(9.0./2.0)+s.^3.*(9.0./2.0);...
                    t-s.*t.*3.816391647148973e-16+s.*t.^2.*9.436895709313815e-16+s.^2.*t.*9.136611656173047e-31-t.^2.*(9.0./2.0)+t.^3.*(9.0./2.0);...
                    s.*9.0-s.*t.*(4.5e+1./2.0)+s.*t.^2.*(2.7e+1./2.0)+s.^2.*t.*2.7e+1-s.^2.*(4.5e+1./2.0)+s.^3.*(2.7e+1./2.0);...
                    s.*(-9.0./2.0)+s.*t.*(9.0./2.0)-s.*t.^2.*6.38378239159465e-16-s.^2.*t.*(2.7e+1./2.0)+s.^2.*1.8e+1-s.^3.*(2.7e+1./2.0);...
                    s.*t.*(-9.0./2.0)+s.*t.^2.*6.38378239159465e-16+s.^2.*t.*(2.7e+1./2.0);...
                    s.*t.*(-9.0./2.0)+s.*t.^2.*(2.7e+1./2.0)+s.^2.*t.*3.747002708109903e-16;...
                    t.*(-9.0./2.0)+s.*t.*(9.0./2.0)-s.*t.^2.*(2.7e+1./2.0)-s.^2.*t.*1.873501354054952e-15+t.^2.*1.8e+1-t.^3.*(2.7e+1./2.0);...
                    t.*9.0-s.*t.*(4.5e+1./2.0)+s.*t.^2.*2.7e+1+s.^2.*t.*(2.7e+1./2.0)-t.^2.*(4.5e+1./2.0)+t.^3.*(2.7e+1./2.0);...
                    s.*t.*2.7e+1-s.*t.^2.*2.7e+1-s.^2.*t.*2.7e+1];
            end
        end
        
        function computeShapeDerivatives(obj,posgp)
            ngaus = size(posgp,2);
            for igaus=1:ngaus
                s = posgp(1,igaus);
                t = posgp(2,igaus);
                obj.deriv(:,:,igaus) = [s.*1.8e+1+t.*1.8e+1-s.*t.*2.7e+1-s.^2.*(2.7e+1./2.0)-t.^2.*(2.7e+1./2.0)-1.1e+1./2.0,...
                    s.*-9.0+s.^2.*(2.7e+1./2.0)+1.0,...
                    t.*(-3.816391647148973e-16)+s.*t.*1.827322331234609e-30+t.^2.*9.436895709313815e-16,...
                    s.*-4.5e+1-t.*(4.5e+1./2.0)+s.*t.*5.4e+1+s.^2.*(8.1e+1./2.0)+t.^2.*(2.7e+1./2.0)+9.0,...
                    s.*3.6e+1+t.*(9.0./2.0)-s.*t.*2.7e+1-s.^2.*(8.1e+1./2.0)-t.^2.*6.38378239159465e-16-9.0./2.0,...
                    t.*(-9.0./2.0)+s.*t.*2.7e+1+t.^2.*6.38378239159465e-16,...
                    t.*(-9.0./2.0)+s.*t.*7.494005416219807e-16+t.^2.*(2.7e+1./2.0),...
                    t.*(9.0./2.0)-s.*t.*3.747002708109903e-15-t.^2.*(2.7e+1./2.0),...
                    t.*(-4.5e+1./2.0)+s.*t.*2.7e+1+t.^2.*2.7e+1,...
                    t.*2.7e+1-s.*t.*5.4e+1-t.^2.*2.7e+1; ...
                    
                    s.*1.8e+1+t.*1.8e+1-s.*t.*2.7e+1-s.^2.*(2.7e+1./2.0)-t.^2.*(2.7e+1./2.0)-1.1e+1./2.0,...
                    0.0,...
                    s.*(-3.816391647148973e-16)-t.*9.0+s.*t.*1.887379141862763e-15+s.^2.*9.136611656173047e-31+t.^2.*(2.7e+1./2.0)+1.0,...
                    s.*(-4.5e+1./2.0)+s.*t.*2.7e+1+s.^2.*2.7e+1,...
                    s.*(9.0./2.0)-s.*t.*1.27675647831893e-15-s.^2.*(2.7e+1./2.0),...
                    s.*(-9.0./2.0)+s.*t.*1.27675647831893e-15+s.^2.*(2.7e+1./2.0),...
                    s.*(-9.0./2.0)+s.*t.*2.7e+1+s.^2.*3.747002708109903e-16,...
                    s.*(9.0./2.0)+t.*3.6e+1-s.*t.*2.7e+1-s.^2.*1.873501354054952e-15-t.^2.*(8.1e+1./2.0)-9.0./2.0,...
                    s.*(-4.5e+1./2.0)-t.*4.5e+1+s.*t.*5.4e+1+s.^2.*(2.7e+1./2.0)+t.^2.*(8.1e+1./2.0)+9.0,...
                    s.*2.7e+1-s.*t.*5.4e+1-s.^2.*2.7e+1];
            end
        end
        
    end
end